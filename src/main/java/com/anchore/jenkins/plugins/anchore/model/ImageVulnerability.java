package com.anchore.jenkins.plugins.anchore.model;

import com.j256.ormlite.field.DatabaseField;
import com.j256.ormlite.table.DatabaseTable;

@DatabaseTable(tableName = "IMAGEVULNERABILITIES")
public class ImageVulnerability {
    private static String NAME_COLUMN = "IMAGENAME";
    private static String DIGEST_COLUMN = "IMAGEDIGEST";

    private static String getColumNameOfField(String fieldname) {
        try {
            return ImageVulnerability.class.getDeclaredField(fieldname).getAnnotation(DatabaseField.class).columnName();
        } catch (NoSuchFieldException e) {
            e.printStackTrace();
        }

        return null;
    }

    public static String getImageNameColumn() {
        return getColumNameOfField("imagename");
    }

    public static String getImageDigestColumn() {
        return getColumNameOfField("imagedigest");
    }

    @DatabaseField(columnName = "ID")
    private int id = 0;
    @DatabaseField(columnName = "AVAILABILITY")
    private String availability;
    @DatabaseField(columnName = "CONFIDENTIALITY")
    private String confidentiality;
    @DatabaseField(columnName = "CVSSSCORE")
    private double cvssScore;
    @DatabaseField(columnName = "CVSSVECTOR")
    private String cvssVector;
    @DatabaseField(columnName = "CWEID")
    private String cweId;
    @DatabaseField(columnName = "IDENTIFIER")
    private String cveId;
    @DatabaseField(columnName = "IMAGENAME")
    private String imagename;
    @DatabaseField(columnName = "INTEGRITY")
    private String integrity;
    @DatabaseField(columnName = "TIMESTAMP")
    private String timestamp;
    @DatabaseField(columnName = "IMAGEDIGEST")
    private String imagedigest;

    @DatabaseField(columnName = "PACKAGE")
    private String vulnerabilityPackage;
    @DatabaseField(columnName = "URL")
    private String url;
    @DatabaseField(columnName = "FIXAVAILABLE")
    private String fixAvailable;

    public ImageVulnerability() {
        this.id = 0;
    }

    public String getSeverity() {
        if (cvssScore < 0.1)
            return "None";
        else if (cvssScore < 4.0)
            return "Low";
        else if (cvssScore < 7.0)
            return "Medium";
        else if (cvssScore < 9.0)
            return "High";
        else return "Critical";
    }

    public void setCvssScore(double cvssScore) {
        this.cvssScore = cvssScore;
    }

    public String getImagedigest() {
        return imagedigest;
    }

    public void setImagedigest(String imagedigest) {
        this.imagedigest = imagedigest;
    }

    public int getId() {
        return id;
    }

    public void setId(int id) {
        this.id = id;
    }

    public String getImagename() {
        return imagename;
    }

    public void setImagename(String imagename) {
        this.imagename = imagename;
    }

    public String getTimestamp() {
        return timestamp;
    }

    public void setTimestamp(String timestamp) {
        this.timestamp = timestamp;
    }

    public String getAvailability() {
        return availability;
    }

    public void setAvailability(String availability) {
        this.availability = availability;
    }

    public String getConfidentiality() {
        return confidentiality;
    }

    public void setConfidentiality(String confidentiality) {
        this.confidentiality = confidentiality;
    }

    public Double getCvssScore() {
        return cvssScore;
    }

    public void setCvssScore(Double cvssScore) {
        this.cvssScore = cvssScore;
    }

    public String getCvssVector() {
        return cvssVector;
    }

    public void setCvssVector(String cvssVector) {
        this.cvssVector = cvssVector;
    }

    public String getCweId() {
        return cweId;
    }

    public void setCweId(String cweId) {
        this.cweId = cweId;
    }

    public String getIntegrity() {
        return integrity;
    }

    public void setIntegrity(String integrity) {
        this.integrity = integrity;
    }

    public String getCveId() {
        return cveId;
    }

    public void setCveId(String cveId) {
        this.cveId = cveId;
    }

    public String getVulnerabilityPackage() {
        return vulnerabilityPackage;
    }

    public void setVulnerabilityPackage(String vulnerabilityPackage) {
        this.vulnerabilityPackage = vulnerabilityPackage;
    }

    public String getUrl() {
        return url;
    }

    public void setUrl(String url) {
        this.url = url;
    }

    public String getFixAvailable() {
        return fixAvailable;
    }

    public void setFixAvailable(String fixAvailable) {
        this.fixAvailable = fixAvailable;
    }
}
